{

"Snippet: PageWizard": {
        "prefix": "tpagewizard",
        "body": [
            "page ${1:Id} \"${2:PageName} Wizard\"",
            "{",
            "\tCaptionML=ENU='${2:PageName}';",
            "\tPageType = NavigatePage;",
            "\tSourceTable = \"${3:TableName}\";",
            "\tSourceTableTemporary=true;",
            "",
            "\tlayout",
            "\t{",
            "\t\tarea(content)",
            "\t\t{",
            

            "\t\t\tgroup(Group96)",
            "\t\t\t{",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible AND NOT Step3Visible;",
            "\t\t\t\tfield(MediaResourcesStandard;MediaResourcesStandard.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea=Basic,Suite,Invoicing;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",
            "\t\t\tgroup(Group98)",
            "\t\t\t{",
            "\t\t\t\tEditable=false;",
            "\t\t\t\tVisible=TopBannerVisible AND Step3Visible;",
            "\t\t\t\tfield(MediaResourcesDone;MediaResourcesDone.\"Media Reference\")",
            "\t\t\t\t{",
            "\t\t\t\t  ApplicationArea=Basic,Suite,Invoicing;",
            "\t\t\t\t  Editable=false;",
            "\t\t\t\t  ShowCaption=false;",
            "\t\t\t\t}",
            "\t\t\t}",  //

			"\t\t}",  //

			"\t}",  //Area

			"}",  //layout

            "trigger OnInit();",
            "begin",
            "  LoadTopBanners;",
            "end;",

            
            "trigger OnOpenPage();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tINIT;",
            "\tIF ${4:RecordVar}.GET THEN BEGIN",
            "\t  TRANSFERFIELDS(${4:RecordVar});",
            "\tEND;",
            "\tINSERT;",
            "",
            "\tStep := Step::Start;",
            "\tEnableControls;",
            "end;",


			"var",
			"\tMediaRepositoryStandard : Record 9400;",
			"\tMediaRepositoryDone : Record 9400;",
			"\tMediaResourcesStandard : Record 2000000182;",
			"\tMediaResourcesDone : Record 2000000182;",
			"\tStep : Option Start,Step2,Finish;",
			"\tTopBannerVisible : Boolean;",
			"\tStep1Visible : Boolean;",
			"\tStep3Visible : Boolean;",
			"\tFinishActionEnabled : Boolean;",
			"\tBackActionEnabled : Boolean;",
			"\tNextActionEnabled : Boolean;",


            "local procedure EnableControls();",
            "begin",
            "  ResetControls;",
            "",
            "  CASE Step OF",
            "    Step::Start:",
            "      ShowStep1;",
            "    Step::Provider:",
            "      ShowStep2;",
            "    Step::Finish:",
            "      ShowStep3;",
            "  END;",
            "end;",
            "",
            "local procedure Store${4:RecordVar}();",
            "var",
            "\t${4:RecordVar} : Record ${3:TableName};",
            "begin",
            "\tIF NOT ${4:RecordVar}.GET THEN BEGIN",
            "\t\t${4:RecordVar}.INIT;",
            "\t\t${4:RecordVar}.INSERT;",
            "\tEND;",
            "",
            "\t${4:RecordVar}.TRANSFERFIELDS(Rec,FALSE);",
            "\t${4:RecordVar}.MODIFY(TRUE);",
            "\tCOMMIT;",
            "end;",
            "",




            "",
            "local procedure FinishAction();",
            "begin",
            "  Store${4:RecordVar};",
            "  CurrPage.CLOSE;",
            "end;",
            "",
            "local procedure NextStep(Backwards : Boolean);",
            "begin",
            "  IF Backwards THEN",
            "    Step := Step - 1",
            "  ELSE",
            "    Step := Step + 1;",
            "",
            "  EnableControls;",
            "end;",
            "",
            "local procedure ShowStep1();",
            "begin",
            "  ${4:Step1}Visible := TRUE;",
            "",
            "  FinishActionEnabled := FALSE;",
            "  BackActionEnabled := FALSE;",
            "end;",
            "",
            "local procedure ShowStep2();",
            "begin",
            "  Step2Visible := TRUE;",
            "end;",
            "",
            "local procedure ShowStep3();",
            "begin",
            "  Step3Visible := TRUE;",
            "",
            "  NextActionEnabled := FALSE;",
            "  FinishActionEnabled := TRUE;",
            "end;",
            "",
            "local procedure ResetControls();",
            "begin",
            "  FinishActionEnabled := FALSE;",
            "  BackActionEnabled := TRUE;",
            "  NextActionEnabled := TRUE;",
            "",
            "  Step1Visible := FALSE;",
            "  Step2Visible := FALSE;",
            "  Step3Visible := FALSE;",
            "end;",
            "",





			"local procedure LoadTopBanners();",
			"begin",
			"  IF MediaRepositoryStandard.GET('AssistedSetup-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE)) AND",
			"     MediaRepositoryDone.GET('AssistedSetupDone-NoText-400px.png',FORMAT(CURRENTCLIENTTYPE))",
			"  THEN",
			"    IF MediaResourcesStandard.GET(MediaRepositoryStandard.\"Media Resources Ref\") AND",
			"       MediaResourcesDone.GET(MediaRepositoryDone.\"Media Resources Ref\")",
			"    THEN",
			"      TopBannerVisible := MediaResourcesDone.\"Media Reference\".HASVALUE;",
			"end;",

            "}"
        ]
    }

}

